rules:
  # ─── Azure Cloud ──────────────────────────────────────────────────────────────

  - id: sec-001
    name: Azure Storage Account Key
    description: Detects Azure Storage account access keys embedded in code or config
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 70
    patterns:
      - type: regex
        pattern: 'AccountKey=[A-Za-z0-9+/]{86}=='
        weight: 100
        description: Azure Storage connection string AccountKey value
      - type: regex
        pattern: 'DefaultEndpointsProtocol=https;AccountName=[^;]+;AccountKey='
        weight: 98
        description: Full Azure Storage connection string pattern
      - type: regex
        pattern: '[Aa]zure[Ss]torage[Kk]ey\s*[=:]\s*["''][A-Za-z0-9+/]{80,88}={0,2}["'']'
        weight: 90
        description: Azure storage key in variable assignment
    remediation: |
      Never hardcode Azure Storage keys. Use managed identities, Azure Key Vault, or
      environment variables instead:
        - Assign the Storage Blob Data Contributor role to your managed identity
        - Reference secrets via Key Vault references in App Service configuration
        - Rotate the exposed key immediately in the Azure portal

  - id: sec-002
    name: Azure SAS Token
    description: Detects Azure Shared Access Signature tokens which grant time-limited storage access
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'sv=\d{4}-\d{2}-\d{2}&s[spcqotf]=.*&sig=[A-Za-z0-9%+/]+'
        weight: 95
        description: Azure SAS token query string parameters
      - type: regex
        pattern: 'SharedAccessSignature\s+sr=[^&]+&sig=[A-Za-z0-9%+/]+'
        weight: 97
        description: Azure SAS token in Authorization header format
    remediation: |
      SAS tokens provide direct access to Azure resources. If exposed:
        - Revoke the SAS token by regenerating the storage account key it was derived from
        - Use short-lived SAS tokens generated server-side on demand
        - Prefer managed identities over SAS tokens for service-to-service access

  - id: sec-003
    name: Azure Active Directory Client Secret
    description: Detects Azure AD application client secrets used for service principal authentication
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: '[Cc]lient[Ss]ecret\s*[=:]\s*["''][A-Za-z0-9._~-]{34,40}["'']'
        weight: 85
        description: Azure AD client secret in assignment
      - type: regex
        pattern: 'AZURE_CLIENT_SECRET\s*=\s*[A-Za-z0-9._~-]{34,}'
        weight: 90
        description: Azure client secret environment variable value
      - type: regex
        pattern: '"clientSecret":\s*"[A-Za-z0-9._~-]{34,40}"'
        weight: 88
        description: Azure client secret in JSON config
    remediation: |
      Rotate the Azure AD client secret immediately in the Azure portal under
      App Registrations > Certificates & secrets. Switch to certificate-based
      authentication or managed identities to avoid secret rotation entirely.

  - id: sec-004
    name: Azure Subscription Key (Cognitive Services / API Management)
    description: Detects Azure API Management or Cognitive Services subscription keys
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: '[Oo]cp-[Aa]pim-[Ss]ubscription-[Kk]ey:\s*[A-Fa-f0-9]{32}'
        weight: 98
        description: Azure APIM subscription key HTTP header value
      - type: regex
        pattern: 'AZURE_SUBSCRIPTION_KEY\s*=\s*[A-Fa-f0-9]{32}'
        weight: 95
        description: Azure subscription key in environment variable
      - type: regex
        pattern: '"subscriptionKey":\s*"[A-Fa-f0-9]{32}"'
        weight: 92
        description: Azure subscription key in JSON
    remediation: |
      Regenerate the exposed subscription key in Azure API Management or Cognitive
      Services. Use Azure Key Vault to store and retrieve keys at runtime rather
      than embedding them in source or config files.

  # ─── Alibaba Cloud ────────────────────────────────────────────────────────────

  - id: sec-005
    name: Alibaba Cloud Access Key
    description: Detects Alibaba Cloud (Aliyun) access key IDs and secrets
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 70
    patterns:
      - type: regex
        pattern: 'LTAI[A-Za-z0-9]{16,24}'
        weight: 100
        description: Alibaba Cloud Access Key ID (LTAI prefix)
      - type: regex
        pattern: '[Aa]liyun[Aa]ccess[Kk]ey\s*[=:]\s*["''][A-Za-z0-9]{30,}["'']'
        weight: 85
        description: Alibaba Cloud access key in variable assignment
      - type: regex
        pattern: 'ALIBABA_CLOUD_ACCESS_KEY_SECRET\s*=\s*[A-Za-z0-9]{30,}'
        weight: 95
        description: Alibaba Cloud access key secret environment variable
    remediation: |
      Revoke the exposed Alibaba Cloud access key in the RAM console immediately.
      Use RAM roles with STS temporary credentials or instance RAM roles instead
      of long-lived access key pairs.

  # ─── IBM Cloud ────────────────────────────────────────────────────────────────

  - id: sec-006
    name: IBM Cloud API Key
    description: Detects IBM Cloud IAM API keys
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 70
    patterns:
      - type: regex
        pattern: '["'']?[Ii][Bb][Mm]_?[Cc][Ll][Oo][Uu][Dd]_?[Aa][Pp][Ii]_?[Kk][Ee][Yy]["'']?\s*[=:]\s*["''][A-Za-z0-9_-]{40,50}["'']'
        weight: 90
        description: IBM Cloud API key in variable assignment
      - type: regex
        pattern: 'IBMCLOUD_API_KEY\s*=\s*[A-Za-z0-9_-]{40,50}'
        weight: 95
        description: IBM Cloud API key environment variable
      - type: regex
        pattern: '"apikey":\s*"[A-Za-z0-9_-]{40,50}"'
        weight: 85
        description: IBM Cloud API key in JSON configuration
    remediation: |
      Revoke the IBM Cloud API key in the IAM console (Manage > Access > API keys).
      Use service IDs with IAM policies scoped to the minimum required permissions
      and generate keys via the API rather than storing static keys.

  # ─── Stripe ───────────────────────────────────────────────────────────────────

  - id: sec-007
    name: Stripe Live Secret Key
    description: Detects Stripe live-mode secret API keys which allow full account access
    category: secret-detection
    severity: critical
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 55
    patterns:
      - type: regex
        pattern: 'sk_live_[A-Za-z0-9]{24,}'
        weight: 100
        description: Stripe live secret key (sk_live_ prefix)
    remediation: |
      This is a critical incident. A Stripe live secret key can create charges,
      access customer data, and perform refunds. Immediately:
        1. Roll the key in the Stripe dashboard (Developers > API keys)
        2. Audit recent API calls for unauthorized activity
        3. Store keys exclusively in environment variables or a secrets manager

  - id: sec-008
    name: Stripe Live Publishable Key
    description: Detects Stripe live-mode publishable keys which can be used to initiate payments
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: 'pk_live_[A-Za-z0-9]{24,}'
        weight: 100
        description: Stripe live publishable key (pk_live_ prefix)
    remediation: |
      While publishable keys are designed for client-side use, they should not
      appear in server-side secrets files or VCS history. If the corresponding
      secret key is also exposed, treat this as a critical incident.
      Roll both keys in the Stripe dashboard.

  - id: sec-009
    name: Stripe Restricted Key
    description: Detects Stripe restricted API keys
    category: secret-detection
    severity: critical
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 55
    patterns:
      - type: regex
        pattern: 'rk_live_[A-Za-z0-9]{24,}'
        weight: 100
        description: Stripe live restricted key (rk_live_ prefix)
    remediation: |
      Roll the restricted key immediately in the Stripe dashboard (Developers >
      API keys). Even restricted keys can perform sensitive operations within
      their scope. Store all Stripe keys in a secrets manager, never in source code.

  # ─── Square ───────────────────────────────────────────────────────────────────

  - id: sec-010
    name: Square Application Secret
    description: Detects Square OAuth application secrets and access tokens
    category: secret-detection
    severity: critical
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: 'sq0csp-[A-Za-z0-9_-]{43}'
        weight: 100
        description: Square application secret (sq0csp- prefix)
      - type: regex
        pattern: 'sq0atp-[A-Za-z0-9_-]{22,}'
        weight: 100
        description: Square access token (sq0atp- prefix)
    remediation: |
      Revoke the exposed Square credential immediately in the Square Developer
      dashboard under OAuth > Applications. Square application secrets can be
      used to impersonate your application. Rotate and store exclusively in a
      secrets manager or environment variables.

  # ─── PayPal ───────────────────────────────────────────────────────────────────

  - id: sec-011
    name: PayPal / Braintree Credentials
    description: Detects PayPal REST API client secrets and Braintree tokens
    category: secret-detection
    severity: critical
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: '[Pp]ay[Pp]al[Cc]lient[Ss]ecret\s*[=:]\s*["''][A-Za-z0-9_-]{20,}["'']'
        weight: 90
        description: PayPal client secret in variable
      - type: regex
        pattern: 'PAYPAL_CLIENT_SECRET\s*=\s*[A-Za-z0-9_-]{20,}'
        weight: 95
        description: PayPal client secret environment variable
      - type: regex
        pattern: '[Bb]raintree[Pp]rivate[Kk]ey\s*[=:]\s*["''][A-Za-z0-9]{32}["'']'
        weight: 92
        description: Braintree private key in variable
      - type: regex
        pattern: 'access_token\$production\$[A-Za-z0-9]{16}\$[A-Za-z0-9]{32}'
        weight: 100
        description: PayPal live access token pattern
    remediation: |
      Revoke PayPal/Braintree credentials immediately in their respective dashboards.
      These credentials can process financial transactions. Use environment variables
      or a secrets manager and enforce secret scanning on your repositories.

  # ─── Twilio ───────────────────────────────────────────────────────────────────

  - id: sec-012
    name: Twilio Account SID and Auth Token
    description: Detects Twilio account credentials which enable SMS/voice actions and billing
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'AC[a-f0-9]{32}'
        weight: 95
        description: Twilio Account SID (AC prefix followed by 32 hex chars)
      - type: regex
        pattern: 'TWILIO_ACCOUNT_SID\s*=\s*AC[a-f0-9]{32}'
        weight: 100
        description: Twilio Account SID in environment variable
      - type: regex
        pattern: 'TWILIO_AUTH_TOKEN\s*=\s*[a-f0-9]{32}'
        weight: 100
        description: Twilio Auth Token environment variable
      - type: regex
        pattern: '[Tt]wilio[Aa]uth[Tt]oken\s*[=:]\s*["''][a-f0-9]{32}["'']'
        weight: 95
        description: Twilio auth token in variable assignment
    remediation: |
      Rotate the Twilio auth token immediately in the Twilio Console under
      Account > General Settings. Auth tokens can send SMS/calls charged to
      your account. Use API Keys (more limited scope) instead of auth tokens
      where possible.

  # ─── SendGrid ─────────────────────────────────────────────────────────────────

  - id: sec-013
    name: SendGrid API Key
    description: Detects SendGrid email API keys which allow sending emails on your behalf
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: 'SG\.[A-Za-z0-9_-]{22}\.[A-Za-z0-9_-]{43}'
        weight: 100
        description: SendGrid API key (SG. prefix with exact format)
    remediation: |
      Delete the exposed SendGrid API key immediately in Settings > API Keys.
      Create a replacement key with the minimum required permissions (e.g.,
      Mail Send only). Store in environment variables or a secrets manager.

  # ─── Mailgun ──────────────────────────────────────────────────────────────────

  - id: sec-014
    name: Mailgun API Key
    description: Detects Mailgun email service API keys
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'key-[A-Za-z0-9]{32}'
        weight: 90
        description: Mailgun legacy API key (key- prefix)
      - type: regex
        pattern: 'MAILGUN_API_KEY\s*=\s*[A-Za-z0-9_-]{32,}'
        weight: 95
        description: Mailgun API key environment variable
      - type: regex
        pattern: '[Mm]ailgun[Aa][Pp][Ii][Kk]ey\s*[=:]\s*["''][A-Za-z0-9_-]{32,}["'']'
        weight: 90
        description: Mailgun API key in variable assignment
    remediation: |
      Rotate the Mailgun API key in the Mailgun Control Panel under Settings > API Keys.
      Use domain-level sending keys rather than the primary account API key to limit
      the blast radius of a leak.

  # ─── Mailchimp ────────────────────────────────────────────────────────────────

  - id: sec-015
    name: Mailchimp API Key
    description: Detects Mailchimp marketing API keys
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: '[A-Za-z0-9]{32}-us\d{1,2}'
        weight: 95
        description: Mailchimp API key with datacenter suffix (e.g., -us6)
      - type: regex
        pattern: 'MAILCHIMP_API_KEY\s*=\s*[A-Za-z0-9]{32}-us\d{1,2}'
        weight: 100
        description: Mailchimp API key in environment variable
    remediation: |
      Revoke the Mailchimp API key in Account > Extras > API Keys. Create a new
      key with read-only access where possible and store in environment variables.

  # ─── Postmark ─────────────────────────────────────────────────────────────────

  - id: sec-016
    name: Postmark Server Token
    description: Detects Postmark transactional email server API tokens
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'POSTMARK_SERVER_TOKEN\s*=\s*[A-Za-z0-9_-]{36}'
        weight: 98
        description: Postmark server token environment variable
      - type: regex
        pattern: '[Pp]ostmark[Tt]oken\s*[=:]\s*["''][A-Za-z0-9_-]{36}["'']'
        weight: 92
        description: Postmark token in variable assignment
      - type: regex
        pattern: 'X-Postmark-Server-Token:\s*[A-Za-z0-9_-]{36}'
        weight: 98
        description: Postmark server token in HTTP header
    remediation: |
      Regenerate the Postmark server token in the Postmark app under Servers >
      API Tokens. Use separate tokens per environment and store in a secrets manager.

  # ─── Heroku ───────────────────────────────────────────────────────────────────

  - id: sec-017
    name: Heroku API Key
    description: Detects Heroku platform API keys which allow full account management
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'HEROKU_API_KEY\s*=\s*[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}'
        weight: 100
        description: Heroku API key UUID format in environment variable
      - type: regex
        pattern: '[Hh]eroku[Aa]pi[Kk]ey\s*[=:]\s*["''][A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}["'']'
        weight: 95
        description: Heroku API key in variable assignment
    remediation: |
      Revoke the Heroku API key in Account Settings > API Key. Heroku API keys
      grant full control over all your apps and pipelines. Use OAuth tokens with
      limited scopes for CI/CD automation instead.

  # ─── DigitalOcean ─────────────────────────────────────────────────────────────

  - id: sec-018
    name: DigitalOcean Personal Access Token
    description: Detects DigitalOcean API tokens for infrastructure management
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: 'dop_v1_[A-Za-z0-9]{64}'
        weight: 100
        description: DigitalOcean personal access token (dop_v1_ prefix)
      - type: regex
        pattern: 'DIGITALOCEAN_TOKEN\s*=\s*dop_v1_[A-Za-z0-9]{64}'
        weight: 100
        description: DigitalOcean token in environment variable
      - type: regex
        pattern: 'DO_AUTH_TOKEN\s*=\s*[A-Za-z0-9]{64}'
        weight: 88
        description: DigitalOcean auth token variable
    remediation: |
      Delete the token in DigitalOcean API Settings and generate a new one with
      read-only or scoped access. DigitalOcean tokens with write access can
      create/destroy Droplets and databases.

  # ─── Terraform ────────────────────────────────────────────────────────────────

  - id: sec-019
    name: Terraform Cloud Token
    description: Detects Terraform Cloud / Enterprise API tokens
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'TF_TOKEN_[A-Z_]+\s*=\s*[A-Za-z0-9.]{47,}'
        weight: 95
        description: Terraform Cloud token via TF_TOKEN_ environment variable
      - type: regex
        pattern: '"token"\s*:\s*"[A-Za-z0-9.]{47,}"'
        weight: 85
        description: Terraform token in .terraformrc or credentials.tfrc.json
      - type: regex
        pattern: 'TFC_TOKEN\s*=\s*[A-Za-z0-9.]{47,}'
        weight: 95
        description: Terraform Cloud token (TFC_TOKEN variable)
    remediation: |
      Revoke the token in Terraform Cloud under User/Organization Settings > Tokens.
      Terraform tokens can apply infrastructure changes. Use short-lived tokens and
      machine users (team tokens) for CI pipelines rather than personal tokens.

  # ─── Sentry ───────────────────────────────────────────────────────────────────

  - id: sec-020
    name: Sentry DSN
    description: Detects Sentry Data Source Names which expose project identifiers and can ingest events
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 70
    patterns:
      - type: regex
        pattern: 'https://[A-Za-z0-9]{32}@o[0-9]+\.ingest\.sentry\.io/[0-9]+'
        weight: 100
        description: Full Sentry DSN URL pattern
      - type: regex
        pattern: 'SENTRY_DSN\s*=\s*https://[A-Za-z0-9]{32}@'
        weight: 100
        description: Sentry DSN in environment variable
    remediation: |
      Sentry DSNs are semi-public (client-side use is expected) but should not
      appear in server-side secret stores or allow event submission from untrusted
      sources. Enable rate limiting and trusted domain filtering in Sentry project
      settings. For server-side Sentry auth tokens, treat as high severity.

  # ─── CircleCI ─────────────────────────────────────────────────────────────────

  - id: sec-021
    name: CircleCI API Token
    description: Detects CircleCI personal or project API tokens
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'CIRCLE_TOKEN\s*=\s*[A-Fa-f0-9]{40}'
        weight: 98
        description: CircleCI token environment variable (40 hex chars)
      - type: regex
        pattern: 'CIRCLECI_TOKEN\s*=\s*[A-Fa-f0-9]{40}'
        weight: 98
        description: CircleCI token alternative env var name
      - type: regex
        pattern: '[Cc]ircle[Cc][Ii][Tt]oken\s*[=:]\s*["''][A-Fa-f0-9]{40}["'']'
        weight: 92
        description: CircleCI token in variable assignment
    remediation: |
      Delete the CircleCI personal API token in User Settings > Personal API Tokens.
      CircleCI tokens with project access can trigger pipelines and read secrets.
      Use project-scoped tokens and rotate them regularly.

  # ─── Travis CI ────────────────────────────────────────────────────────────────

  - id: sec-022
    name: Travis CI API Token
    description: Detects Travis CI authentication tokens
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'TRAVIS_TOKEN\s*=\s*[A-Za-z0-9_-]{20,}'
        weight: 95
        description: Travis CI token environment variable
      - type: regex
        pattern: '[Tt]ravis[Tt]oken\s*[=:]\s*["''][A-Za-z0-9_-]{20,}["'']'
        weight: 88
        description: Travis CI token in variable assignment
    remediation: |
      Regenerate the Travis CI token in Profile > Settings > API Authentication.
      Ensure Travis CI environment variables containing secrets are marked as hidden
      and not displayed in build logs.

  # ─── Codecov ──────────────────────────────────────────────────────────────────

  - id: sec-023
    name: Codecov Upload Token
    description: Detects Codecov coverage upload tokens
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'CODECOV_TOKEN\s*=\s*[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}'
        weight: 100
        description: Codecov token UUID format in environment variable
      - type: regex
        pattern: '[Cc]odecov[Tt]oken\s*[=:]\s*["''][A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}["'']'
        weight: 95
        description: Codecov token in variable assignment
    remediation: |
      Regenerate the Codecov token in repository settings. Codecov tokens can
      be used to upload falsified coverage reports; always store them as CI secrets.

  # ─── Vercel ───────────────────────────────────────────────────────────────────

  - id: sec-024
    name: Vercel API Token
    description: Detects Vercel deployment and management API tokens
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: 'VERCEL_TOKEN\s*=\s*[A-Za-z0-9]{24}'
        weight: 95
        description: Vercel token environment variable (24-char format)
      - type: regex
        pattern: '[Vv]ercel[Tt]oken\s*[=:]\s*["''][A-Za-z0-9]{24}["'']'
        weight: 90
        description: Vercel token in variable assignment
    remediation: |
      Delete the Vercel token in Account Settings > Tokens. Vercel tokens can
      deploy code and manage projects. Use team-scoped tokens with the minimum
      required access level for CI/CD pipelines.

  # ─── Discord ──────────────────────────────────────────────────────────────────

  - id: sec-025
    name: Discord Bot Token
    description: Detects Discord bot tokens which allow full bot account control
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: '[MN][A-Za-z0-9]{23}\.[A-Za-z0-9_-]{6}\.[A-Za-z0-9_-]{27}'
        weight: 98
        description: Discord bot token (3-part JWT-like structure)
      - type: regex
        pattern: 'DISCORD_TOKEN\s*=\s*[A-Za-z0-9_.-]{59,72}'
        weight: 95
        description: Discord bot token in environment variable
      - type: regex
        pattern: '[Dd]iscord[Bb]ot[Tt]oken\s*[=:]\s*["''][A-Za-z0-9_.-]{59,72}["'']'
        weight: 92
        description: Discord bot token in variable assignment
    remediation: |
      Reset the bot token immediately in the Discord Developer Portal under
      Applications > Bot > Reset Token. Anyone with the token can act as your bot,
      join servers, and send messages. Rotate and store in environment variables only.

  - id: sec-026
    name: Discord Webhook URL
    description: Detects Discord webhook URLs which allow posting messages to channels
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 70
    patterns:
      - type: regex
        pattern: 'https://discord(?:app)?\.com/api/webhooks/\d{17,19}/[A-Za-z0-9_-]{60,68}'
        weight: 100
        description: Discord webhook URL with token
    remediation: |
      Delete the webhook in Discord channel settings and recreate it. Discord
      webhooks can be used to spam channels or phish users. Never hardcode
      webhook URLs in client-side code or public repositories.

  # ─── Twitch ───────────────────────────────────────────────────────────────────

  - id: sec-027
    name: Twitch API Credentials
    description: Detects Twitch application client secrets and OAuth tokens
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'TWITCH_CLIENT_SECRET\s*=\s*[A-Za-z0-9]{30}'
        weight: 98
        description: Twitch client secret environment variable
      - type: regex
        pattern: '[Tt]witch[Cc]lient[Ss]ecret\s*[=:]\s*["''][A-Za-z0-9]{30}["'']'
        weight: 92
        description: Twitch client secret in variable assignment
      - type: regex
        pattern: 'oauth:[A-Za-z0-9]{30}'
        weight: 95
        description: "Twitch OAuth token (oauth: prefix used in IRC/chat)"
    remediation: |
      Revoke the Twitch application secret in the Twitch Developer Console.
      OAuth tokens should be treated as passwords and stored only in secure
      server-side secret stores.

  # ─── Telegram ─────────────────────────────────────────────────────────────────

  - id: sec-028
    name: Telegram Bot Token
    description: Detects Telegram bot API tokens issued by BotFather
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: '\d{8,10}:[A-Za-z0-9_-]{35}'
        weight: 95
        description: "Telegram bot token (numeric ID : random string)"
      - type: regex
        pattern: 'TELEGRAM_BOT_TOKEN\s*=\s*\d{8,10}:[A-Za-z0-9_-]{35}'
        weight: 100
        description: Telegram bot token in environment variable
      - type: regex
        pattern: 'bot\d{8,10}:[A-Za-z0-9_-]{35}'
        weight: 98
        description: Telegram bot token with bot prefix in URL
    remediation: |
      Request a new token from Telegram's BotFather using /revoke. Anyone with
      the bot token can read all messages sent to the bot and send messages as it.
      Never commit bot tokens to version control.

  # ─── Facebook / Meta ──────────────────────────────────────────────────────────

  - id: sec-029
    name: Facebook / Meta App Secret
    description: Detects Facebook/Meta application secrets and access tokens
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: 'FACEBOOK_APP_SECRET\s*=\s*[A-Fa-f0-9]{32}'
        weight: 98
        description: Facebook app secret environment variable
      - type: regex
        pattern: '[Ff]acebook[Aa]pp[Ss]ecret\s*[=:]\s*["''][A-Fa-f0-9]{32}["'']'
        weight: 92
        description: Facebook app secret in variable assignment
      - type: regex
        pattern: 'EAA[A-Za-z0-9]{100,}'
        weight: 95
        description: Facebook/Meta user or page access token (EAA prefix)
    remediation: |
      Rotate the Facebook app secret in the Meta Developer Console under
      App Settings > Basic. App secrets can generate user access tokens and
      make server-side API calls. Treat them as passwords and never expose
      them in client-side code.

  # ─── Firebase ─────────────────────────────────────────────────────────────────

  - id: sec-030
    name: Firebase API Key
    description: Detects Firebase project configuration API keys and service account credentials
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: '"apiKey":\s*"AIza[A-Za-z0-9_-]{35}"'
        weight: 100
        description: Firebase Web API key in config object
      - type: regex
        pattern: 'AIza[A-Za-z0-9_-]{35}'
        weight: 95
        description: Google/Firebase API key (AIza prefix)
      - type: regex
        pattern: 'FIREBASE_API_KEY\s*=\s*AIza[A-Za-z0-9_-]{35}'
        weight: 100
        description: Firebase API key environment variable
      - type: regex
        pattern: '"databaseURL":\s*"https://[a-z0-9-]+-default-rtdb\.firebaseio\.com"'
        weight: 80
        description: Firebase Realtime Database URL in config
    remediation: |
      Firebase Web API keys are intended for client-side use but should be restricted
      in the Google Cloud Console to specific HTTP referrers or IP addresses.
      For server-side access, use Firebase Admin SDK with a service account and
      store the private key in a secrets manager. Restrict Firebase security rules
      to prevent unauthorized database/storage access.

  # ─── Algolia ──────────────────────────────────────────────────────────────────

  - id: sec-031
    name: Algolia Admin API Key
    description: Detects Algolia admin API keys which provide full index management access
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'ALGOLIA_ADMIN_KEY\s*=\s*[A-Za-z0-9]{32}'
        weight: 98
        description: Algolia admin key environment variable
      - type: regex
        pattern: '[Aa]lgolia[Aa]dmin[Kk]ey\s*[=:]\s*["''][A-Za-z0-9]{32}["'']'
        weight: 92
        description: Algolia admin key in variable assignment
      - type: regex
        pattern: 'X-Algolia-API-Key:\s*[A-Za-z0-9]{32}'
        weight: 95
        description: Algolia API key in HTTP header
    remediation: |
      Rotate the Algolia admin key in API Keys settings. The admin key can add,
      delete, and modify all records and indices. Use search-only or restricted
      API keys for client-side use, and never expose admin keys in frontend code.

  # ─── Segment ──────────────────────────────────────────────────────────────────

  - id: sec-032
    name: Segment Write Key
    description: Detects Segment analytics write keys
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'SEGMENT_WRITE_KEY\s*=\s*[A-Za-z0-9]{32,}'
        weight: 95
        description: Segment write key environment variable
      - type: regex
        pattern: '[Ss]egment[Ww]rite[Kk]ey\s*[=:]\s*["''][A-Za-z0-9]{32,}["'']'
        weight: 88
        description: Segment write key in variable assignment
      - type: regex
        pattern: 'analytics\.load\(\s*["''][A-Za-z0-9]{32,}["'']'
        weight: 90
        description: Segment write key passed to analytics.load()
    remediation: |
      While write keys are designed for client-side use, server-side write keys
      should be stored in environment variables. Rotate in the Segment workspace
      Settings > Sources if you suspect server-side keys were leaked.

  # ─── Mixpanel ─────────────────────────────────────────────────────────────────

  - id: sec-033
    name: Mixpanel Token and Secret
    description: Detects Mixpanel project tokens and API secrets
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'MIXPANEL_TOKEN\s*=\s*[A-Za-z0-9]{32}'
        weight: 90
        description: Mixpanel project token environment variable
      - type: regex
        pattern: 'MIXPANEL_SECRET\s*=\s*[A-Za-z0-9]{32}'
        weight: 95
        description: Mixpanel API secret environment variable
      - type: regex
        pattern: '[Mm]ixpanel\.init\(\s*["''][A-Za-z0-9]{32}["'']'
        weight: 88
        description: Mixpanel token in init() call
    remediation: |
      Mixpanel project tokens are semi-public for ingestion but API secrets
      must be kept server-side. Rotate the API secret in Project Settings if
      exposed. Restrict data export access via Mixpanel service accounts.

  # ─── Datadog ──────────────────────────────────────────────────────────────────

  - id: sec-034
    name: Datadog API and Application Keys
    description: Detects Datadog API keys and application keys for monitoring access
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'DD_API_KEY\s*=\s*[A-Fa-f0-9]{32}'
        weight: 98
        description: Datadog API key environment variable
      - type: regex
        pattern: 'DD_APP_KEY\s*=\s*[A-Fa-f0-9]{40}'
        weight: 98
        description: Datadog application key environment variable
      - type: regex
        pattern: '[Dd]atadog[Aa][Pp][Ii][Kk]ey\s*[=:]\s*["''][A-Fa-f0-9]{32}["'']'
        weight: 92
        description: Datadog API key in variable assignment
      - type: regex
        pattern: 'DD-API-KEY:\s*[A-Fa-f0-9]{32}'
        weight: 97
        description: Datadog API key in HTTP header
    remediation: |
      Revoke and regenerate keys in Datadog Organization Settings > API Keys.
      Datadog application keys have broad read/write access to metrics, logs,
      and monitors. Use scoped API keys and rotate them on a schedule.

  # ─── HashiCorp Vault ──────────────────────────────────────────────────────────

  - id: sec-035
    name: HashiCorp Vault Token
    description: Detects Vault service tokens and batch tokens used for secrets access
    category: secret-detection
    severity: critical
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: 'hvs\.[A-Za-z0-9_-]{24,}'
        weight: 100
        description: Vault service token (hvs. prefix, Vault 1.10+)
      - type: regex
        pattern: 'hvb\.[A-Za-z0-9_-]{24,}'
        weight: 100
        description: Vault batch token (hvb. prefix)
      - type: regex
        pattern: 'VAULT_TOKEN\s*=\s*[A-Za-z0-9._-]{24,}'
        weight: 95
        description: Vault token environment variable
      - type: regex
        pattern: '(?:vault_token|VAULT_TOKEN|vault-token)\s*[:=]\s*s\.[A-Za-z0-9]{24,}'
        weight: 80
        description: Legacy Vault token assigned to known variable
    remediation: |
      Revoke the Vault token immediately using `vault token revoke <token>` or
      via the Vault UI. Vault tokens can access any secret in their policy scope.
      Use short-TTL tokens, AppRole authentication, or Kubernetes auth instead of
      static tokens.

  # ─── Consul ───────────────────────────────────────────────────────────────────

  - id: sec-036
    name: Consul ACL Token
    description: Detects HashiCorp Consul access control list tokens
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'CONSUL_HTTP_TOKEN\s*=\s*[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}'
        weight: 100
        description: Consul HTTP token environment variable (UUID format)
      - type: regex
        pattern: '[Cc]onsul[Tt]oken\s*[=:]\s*["''][A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}["'']'
        weight: 95
        description: Consul token in variable assignment
    remediation: |
      Revoke the Consul ACL token via the Consul API or UI. Consul tokens control
      access to service discovery and KV store. Rotate bootstrap tokens immediately
      and use scoped service tokens for application access.

  # ─── Cloudflare ───────────────────────────────────────────────────────────────

  - id: sec-037
    name: Cloudflare API Token and Key
    description: Detects Cloudflare API tokens and global API keys
    category: secret-detection
    severity: critical
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: 'CLOUDFLARE_API_TOKEN\s*=\s*[A-Za-z0-9_-]{40}'
        weight: 98
        description: Cloudflare API token environment variable (40-char format)
      - type: regex
        pattern: 'CF_API_TOKEN\s*=\s*[A-Za-z0-9_-]{40}'
        weight: 98
        description: Cloudflare API token (CF_ prefix)
      - type: regex
        pattern: 'CLOUDFLARE_API_KEY\s*=\s*[A-Fa-f0-9]{37}'
        weight: 98
        description: Cloudflare global API key environment variable
      - type: regex
        pattern: 'X-Auth-Key:\s*[A-Fa-f0-9]{37}'
        weight: 97
        description: Cloudflare API key in HTTP header
    remediation: |
      Revoke the Cloudflare token in My Profile > API Tokens. Cloudflare global
      API keys have access to your entire account including DNS, WAF, and Workers.
      Use scoped API tokens (not the global key) and grant only the permissions
      required for the specific use case.

  # ─── Base64-Encoded Private Keys ──────────────────────────────────────────────

  - id: sec-038
    name: Base64-Encoded Private Key
    description: Detects base64-encoded PEM private keys used to obfuscate credentials
    category: secret-detection
    severity: critical
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 70
    patterns:
      - type: regex
        pattern: 'LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQ'
        weight: 100
        description: Base64-encoded "-----BEGIN RSA PRIVATE KEY-----"
      - type: regex
        pattern: 'LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0'
        weight: 100
        description: Base64-encoded "-----BEGIN OPENSSH PRIVATE KEY-----"
      - type: regex
        pattern: 'LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0t'
        weight: 100
        description: Base64-encoded "-----BEGIN EC PRIVATE KEY-----"
    remediation: |
      A base64-encoded private key is just as sensitive as the raw PEM key.
      Remove it from code immediately, rotate the key pair, and use a secrets
      manager or environment variable to provide keys at runtime. Encoding is
      not encryption and provides no security benefit.

  # ─── JWT Tokens ───────────────────────────────────────────────────────────────

  - id: sec-039
    name: Hardcoded JWT Token
    description: Detects live JWT tokens hardcoded in source code
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 55
    patterns:
      - type: regex
        pattern: 'eyJ[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}'
        weight: 85
        description: Compact JWT token (header.payload.signature format)
      - type: regex
        pattern: '(?:token|jwt|bearer|auth)\s*[=:]\s*["'']eyJ[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}["'']'
        weight: 92
        description: JWT token assigned to token/auth variable
      - type: regex
        pattern: 'Authorization:\s*Bearer\s+eyJ[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}'
        weight: 95
        description: JWT bearer token in hardcoded Authorization header
    remediation: |
      JWTs contain identity and authorization claims. A hardcoded JWT is valid
      until it expires or the signing key is rotated. Identify the issuer from
      the decoded payload, revoke or invalidate the token if possible, and rotate
      the JWT signing secret/key immediately.

  # ─── Generic High-Entropy Patterns ────────────────────────────────────────────

  - id: sec-040
    name: Generic API Key Assignment
    description: Detects high-entropy strings assigned to variables named key, token, or secret
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 75
    patterns:
      - type: regex
        pattern: '(?:api_key|apikey|api-key)\s*[=:]\s*["''][A-Za-z0-9_\-+/]{32,}["'']'
        weight: 75
        description: High-entropy value assigned to api_key variable
      - type: regex
        pattern: '(?:access_token|accessToken)\s*[=:]\s*["''][A-Za-z0-9_\-+/]{32,}["'']'
        weight: 72
        description: High-entropy value assigned to access_token variable
      - type: regex
        pattern: '(?:client_secret|clientSecret)\s*[=:]\s*["''][A-Za-z0-9_\-+/]{32,}["'']'
        weight: 78
        description: High-entropy value assigned to client_secret variable
    remediation: |
      Replace hardcoded credentials with environment variable references.
      Rotate any exposed keys/tokens. Use a secrets manager such as HashiCorp
      Vault, AWS Secrets Manager, or your cloud provider's equivalent.

  - id: sec-041
    name: Generic Secret in URL Query Parameter
    description: Detects secrets embedded directly in URL query strings
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 70
    patterns:
      - type: regex
        pattern: 'https?://[^"'']+[?&](?:key|token|secret|password|api_key)=[A-Za-z0-9_\-+/]{20,}'
        weight: 85
        description: Credential in URL query parameter
      - type: regex
        pattern: '[?&](?:access_token|auth_token|bearer_token)=[A-Za-z0-9_\-+/]{20,}'
        weight: 90
        description: Bearer or access token in URL query string
    remediation: |
      Never pass secrets as URL query parameters. They are logged by web servers,
      proxies, and browsers. Use HTTP Authorization headers or POST body instead.
      Rotate any exposed secrets immediately.

  - id: sec-042
    name: High-Entropy Hex String Assigned to Secret Variable
    description: Detects 32+ character hex strings assigned to secret-sounding variable names
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 75
    patterns:
      - type: regex
        pattern: '(?:secret|password|passwd|pwd)\s*[=:]\s*["''][A-Fa-f0-9]{32,}["'']'
        weight: 78
        description: Hex string assigned to secret/password variable
      - type: regex
        pattern: '(?:signing_key|sign_key|hmac_key)\s*[=:]\s*["''][A-Fa-f0-9]{32,}["'']'
        weight: 82
        description: Hex string assigned to HMAC or signing key variable
    remediation: |
      Even if these appear to be test values, they may be real secrets committed
      by mistake. Rotate any values that may have been used in production and
      move them to environment variables or a secrets manager.

  # ─── Additional Cloud / Platform Secrets ─────────────────────────────────────

  - id: sec-043
    name: PagerDuty Integration Key
    description: Detects PagerDuty service integration and API keys
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'PAGERDUTY_API_KEY\s*=\s*[A-Za-z0-9+/_-]{20,}'
        weight: 95
        description: PagerDuty API key environment variable
      - type: regex
        pattern: '[Pp]ager[Dd]uty[Ii]ntegration[Kk]ey\s*[=:]\s*["''][A-Za-z0-9+/_-]{32}["'']'
        weight: 88
        description: PagerDuty integration key in variable assignment
    remediation: |
      Revoke the PagerDuty key in Integrations > API Access Keys. Leaked
      integration keys can trigger or silence incidents. Generate minimal-permission
      API keys and store them in a secrets manager.

  - id: sec-044
    name: Zendesk API Token
    description: Detects Zendesk support platform API tokens
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'ZENDESK_TOKEN\s*=\s*[A-Za-z0-9_-]{40,}'
        weight: 95
        description: Zendesk API token environment variable
      - type: regex
        pattern: '[Zz]endesk[Tt]oken\s*[=:]\s*["''][A-Za-z0-9_-]{40,}["'']'
        weight: 90
        description: Zendesk API token in variable assignment
    remediation: |
      Revoke the Zendesk API token in Settings > Apps and Integrations > Zendesk API.
      Zendesk tokens can access ticket data and customer PII. Rotate and store
      securely in a secrets manager.

  - id: sec-045
    name: Shopify Access Token
    description: Detects Shopify private app and OAuth access tokens
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'shppa_[A-Za-z0-9]{32}'
        weight: 100
        description: Shopify private app access token (shppa_ prefix)
      - type: regex
        pattern: 'shpat_[A-Za-z0-9]{32}'
        weight: 100
        description: Shopify OAuth access token (shpat_ prefix)
      - type: regex
        pattern: 'shpca_[A-Za-z0-9]{32}'
        weight: 100
        description: Shopify custom app access token (shpca_ prefix)
      - type: regex
        pattern: 'SHOPIFY_ACCESS_TOKEN\s*=\s*shp[a-z]{2}_[A-Za-z0-9]{32}'
        weight: 100
        description: Shopify access token in environment variable
    remediation: |
      Revoke the Shopify token in Partners > Apps or in the store admin under
      Apps > App and sales channel settings. Shopify tokens can read/write orders,
      customers, and inventory. Rotate immediately if exposed.

  - id: sec-046
    name: Okta API Token
    description: Detects Okta identity platform API tokens
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'OKTA_API_TOKEN\s*=\s*[A-Za-z0-9_-]{42}'
        weight: 98
        description: Okta API token environment variable
      - type: regex
        pattern: '[Oo]kta[Aa][Pp][Ii][Tt]oken\s*[=:]\s*["''][A-Za-z0-9_-]{42}["'']'
        weight: 92
        description: Okta API token in variable assignment
      - type: regex
        pattern: 'SSWS\s+[A-Za-z0-9_-]{42}'
        weight: 100
        description: Okta SSWS API token in Authorization header
    remediation: |
      Revoke the Okta API token in Security > API > Tokens. Okta tokens with
      admin privileges can manage users and applications. Use OAuth 2.0 service
      apps instead of SSWS tokens for non-human access.

  - id: sec-047
    name: Atlassian API Token
    description: Detects Atlassian (Jira/Confluence) API tokens
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'ATLASSIAN_API_TOKEN\s*=\s*[A-Za-z0-9+/]{24}'
        weight: 95
        description: Atlassian API token environment variable
      - type: regex
        pattern: 'JIRA_API_TOKEN\s*=\s*[A-Za-z0-9+/]{24}'
        weight: 95
        description: Jira API token environment variable
      - type: regex
        pattern: '[Aa]tlassian[Tt]oken\s*[=:]\s*["''][A-Za-z0-9+/]{24}["'']'
        weight: 88
        description: Atlassian API token in variable assignment
    remediation: |
      Revoke the Atlassian API token in Account Settings > Security > API tokens.
      These tokens authenticate as your user account. Generate tokens with the
      minimum required permissions and store them in a secrets manager.

  - id: sec-048
    name: Elastic Cloud API Key
    description: Detects Elasticsearch/Elastic Cloud API keys and credentials
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'ELASTIC_API_KEY\s*=\s*[A-Za-z0-9+/]{40,}={0,2}'
        weight: 95
        description: Elastic API key environment variable
      - type: regex
        pattern: 'ApiKey\s+[A-Za-z0-9+/]{40,}={0,2}'
        weight: 92
        description: Elastic API key in Authorization header
      - type: regex
        pattern: '"api_key":\s*\{"id":\s*"[^"]+",\s*"api_key":\s*"[A-Za-z0-9+/]{22,}={0,2}"\}'
        weight: 98
        description: Elastic Cloud API key JSON object with id and api_key
    remediation: |
      Invalidate the API key via the Elasticsearch API:
        DELETE /_security/api_key with the key ID.
      Create replacement keys with minimal index privileges and source IP
      restrictions where possible.

  - id: sec-049
    name: Airtable API Key
    description: Detects Airtable personal access tokens and legacy API keys
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'pat[A-Za-z0-9_]{14}\.[A-Za-z0-9_]{64}'
        weight: 100
        description: Airtable personal access token (pat prefix, new format)
      - type: regex
        pattern: 'key[A-Za-z0-9]{14}'
        weight: 85
        description: Airtable legacy API key (key prefix, 14 alphanum chars)
      - type: regex
        pattern: 'AIRTABLE_API_KEY\s*=\s*key[A-Za-z0-9]{14}'
        weight: 100
        description: Airtable legacy API key in environment variable
    remediation: |
      Revoke the Airtable personal access token in Account > Developer hub > PATs.
      Create replacement tokens scoped to specific bases and operations. Airtable
      keys can read and modify all base data in scope.

  - id: sec-050
    name: Linear API Key
    description: Detects Linear project management API keys
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'lin_api_[A-Za-z0-9]{40}'
        weight: 100
        description: Linear API key (lin_api_ prefix)
      - type: regex
        pattern: 'LINEAR_API_KEY\s*=\s*lin_api_[A-Za-z0-9]{40}'
        weight: 100
        description: Linear API key in environment variable
    remediation: |
      Revoke the Linear API key in Settings > API > Personal API Keys. Create
      a replacement key and store it in a secrets manager or CI/CD secrets.

  - id: sec-051
    name: Notion Integration Token
    description: Detects Notion internal integration tokens
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'secret_[A-Za-z0-9]{43}'
        weight: 95
        description: Notion integration token (secret_ prefix)
      - type: regex
        pattern: 'NOTION_TOKEN\s*=\s*secret_[A-Za-z0-9]{43}'
        weight: 100
        description: Notion integration token in environment variable
    remediation: |
      Revoke the Notion integration token in Settings & Members > Integrations.
      Create a replacement token and limit its access to only the required pages
      and databases.

  - id: sec-052
    name: Pinecone API Key
    description: Detects Pinecone vector database API keys
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'PINECONE_API_KEY\s*=\s*[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}'
        weight: 100
        description: Pinecone API key UUID format in environment variable
      - type: regex
        pattern: '[Pp]inecone[Aa][Pp][Ii][Kk]ey\s*[=:]\s*["''][A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}["'']'
        weight: 95
        description: Pinecone API key in variable assignment
    remediation: |
      Revoke the Pinecone API key in the Pinecone console under API Keys.
      Pinecone keys can upsert, query, and delete vector embeddings. Rotate
      immediately and store replacements in environment variables or a secrets
      manager.

  - id: sec-053
    name: Cohere API Key
    description: Detects Cohere AI API keys for NLP model access
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'COHERE_API_KEY\s*=\s*[A-Za-z0-9]{40}'
        weight: 98
        description: Cohere API key environment variable
      - type: regex
        pattern: '[Cc]ohere[Aa][Pp][Ii][Kk]ey\s*[=:]\s*["''][A-Za-z0-9]{40}["'']'
        weight: 92
        description: Cohere API key in variable assignment
    remediation: |
      Revoke the Cohere API key in the Cohere dashboard under API Keys.
      API keys can be used to invoke paid LLM endpoints. Create a new key
      and store it exclusively in environment variables or a secrets manager.

  - id: sec-054
    name: Hugging Face Token
    description: Detects Hugging Face user access tokens for model hub and inference API
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 60
    patterns:
      - type: regex
        pattern: 'hf_[A-Za-z0-9]{37}'
        weight: 100
        description: Hugging Face user access token (hf_ prefix)
      - type: regex
        pattern: 'HUGGINGFACE_TOKEN\s*=\s*hf_[A-Za-z0-9]{37}'
        weight: 100
        description: Hugging Face token in environment variable
      - type: regex
        pattern: 'HF_TOKEN\s*=\s*hf_[A-Za-z0-9]{37}'
        weight: 100
        description: Hugging Face token (HF_TOKEN variable)
    remediation: |
      Revoke the token in Hugging Face Account Settings > Access Tokens.
      Tokens with write access can modify model repositories and datasets.
      Use read-only tokens for inference workloads and store in a secrets manager.

  - id: sec-055
    name: Replicate API Token
    description: Detects Replicate AI inference platform API tokens
    category: secret-detection
    severity: high
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'r8_[A-Za-z0-9]{37}'
        weight: 100
        description: Replicate API token (r8_ prefix)
      - type: regex
        pattern: 'REPLICATE_API_TOKEN\s*=\s*r8_[A-Za-z0-9]{37}'
        weight: 100
        description: Replicate API token in environment variable
    remediation: |
      Revoke the Replicate API token in Account Settings > API Tokens.
      Tokens can be used to run paid model predictions. Create a replacement
      and store in environment variables or a secrets manager.

  - id: sec-056
    name: Supabase Service Role Key (Inline)
    description: Detects full Supabase service role JWT tokens hardcoded inline
    category: secret-detection
    severity: critical
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 55
    patterns:
      - type: regex
        pattern: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+'
        weight: 85
        description: Supabase-style JWT with standard header (common in Supabase keys)
      - type: regex
        pattern: 'SUPABASE_SERVICE_ROLE_KEY\s*=\s*eyJ[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+'
        weight: 100
        description: Supabase service role key in environment variable
    remediation: |
      The Supabase service role key bypasses Row Level Security on all tables.
      Rotate it immediately in the Supabase dashboard under Settings > API.
      Never expose it in client-side code or commit it to version control.
      Use the anon key for client-side access and apply strict RLS policies.

  - id: sec-057
    name: Pusher Application Secret
    description: Detects Pusher real-time API application secrets
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'PUSHER_APP_SECRET\s*=\s*[A-Za-z0-9]{20}'
        weight: 98
        description: Pusher application secret environment variable
      - type: regex
        pattern: '[Pp]usher[Aa]pp[Ss]ecret\s*[=:]\s*["''][A-Za-z0-9]{20}["'']'
        weight: 90
        description: Pusher app secret in variable assignment
    remediation: |
      Rotate the Pusher app secret in the Pusher dashboard under App Keys.
      The app secret is used to sign webhook payloads and authenticate server-side
      publishing. Store in environment variables only.

  - id: sec-058
    name: Amplitude API Key and Secret
    description: Detects Amplitude analytics API keys and secret keys
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'AMPLITUDE_API_KEY\s*=\s*[A-Za-z0-9]{32}'
        weight: 95
        description: Amplitude API key environment variable
      - type: regex
        pattern: 'AMPLITUDE_SECRET_KEY\s*=\s*[A-Za-z0-9]{32}'
        weight: 98
        description: Amplitude secret key environment variable
      - type: regex
        pattern: '[Aa]mplitude[Ss]ecret[Kk]ey\s*[=:]\s*["''][A-Za-z0-9]{32}["'']'
        weight: 90
        description: Amplitude secret key in variable assignment
    remediation: |
      Rotate keys in Amplitude under Settings > Projects. The secret key is
      required for server-side event ingestion and export APIs. Store in a
      secrets manager and use the API key for client-side tracking only.

  - id: sec-059
    name: Mapbox Access Token
    description: Detects Mapbox public and secret access tokens
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'pk\.[A-Za-z0-9_-]{80,}'
        weight: 90
        description: Mapbox public access token (pk. prefix)
      - type: regex
        pattern: 'sk\.[A-Za-z0-9_-]{80,}'
        weight: 98
        description: Mapbox secret access token (sk. prefix)
      - type: regex
        pattern: 'MAPBOX_ACCESS_TOKEN\s*=\s*(?:pk|sk)\.[A-Za-z0-9_-]{80,}'
        weight: 100
        description: Mapbox access token in environment variable
    remediation: |
      Rotate the Mapbox token in Account > Access Tokens. Secret tokens should
      never appear in client-side code. Public tokens should be URL-restricted
      in Mapbox account settings to prevent unauthorized tile requests.

  - id: sec-060
    name: Intercom Access Token
    description: Detects Intercom customer messaging platform access tokens
    category: secret-detection
    severity: medium
    version: "1.0.0"
    enabled: true
    confidenceThreshold: 65
    patterns:
      - type: regex
        pattern: 'INTERCOM_ACCESS_TOKEN\s*=\s*dG9r[A-Za-z0-9+/=]{40,}'
        weight: 100
        description: Intercom access token (base64 starting with dG9r for "tok")
      - type: regex
        pattern: '[Ii]ntercom[Aa]ccess[Tt]oken\s*[=:]\s*["'']dG9r[A-Za-z0-9+/=]{40,}["'']'
        weight: 95
        description: Intercom access token in variable assignment
    remediation: |
      Revoke the Intercom access token in Settings > Developers > Access tokens.
      Intercom tokens can read customer conversations and user data. Store in a
      secrets manager and scope to the minimum required permissions.
